<div id="roaster-list" class="mt-6" data-star-scope="roasters">
  {% if roasters.items.is_empty() %}
  <div
    class="rounded-lg border border-dashed border-amber-300 bg-amber-100/40 px-4 py-6 text-sm text-stone-600"
  >
    <p class="text-center">
      No roasters recorded yet. Use the form above to add your first roaster.
    </p>
  </div>
  {% else %}
  <section class="rounded-lg border border-amber-300 bg-amber-100/80 shadow-sm">
    <div
      class="flex flex-col gap-3 border-b border-amber-200/70 px-4 py-3 text-xs text-stone-600 sm:flex-row sm:items-center sm:justify-between"
    >
      <p>
        Showing {{ roasters.start_index() }}&ndash;{{ roasters.end_index() }} of {{ roasters.total
        }} roasters
      </p>
      <div class="flex flex-wrap items-center gap-3">
        <div class="flex items-center gap-2">
          <button
            type="button"
            class="inline-flex items-center gap-1 rounded-full border border-amber-400 px-3 py-1 font-semibold transition hover:border-amber-500 hover:text-amber-800 disabled:cursor-not-allowed disabled:border-amber-200 disabled:text-amber-300"
            {% if roasters.has_previous() %}
            data-on:click="history.pushState(null, '', '{{ navigator.page_href(roasters.previous_page().unwrap())|safe }}'); @get('{{ navigator.fragment_page_href(roasters.previous_page().unwrap())|safe }}', {responseOverrides: {selector: '#roaster-list', mode: 'replace'}})"
            {% else %}
            disabled
            {% endif %}
          >
            <span aria-hidden="true">←</span>
            <span>Previous</span>
          </button>
          {% if roasters.is_showing_all() %}
          <span class="font-semibold text-amber-800">Showing all results</span>
          {% else %}
          <span class="font-semibold text-amber-800"
            >Page {{ roasters.page }} of {{ roasters.total_pages() }}</span
          >
          {% endif %}
          <button
            type="button"
            class="inline-flex items-center gap-1 rounded-full border border-amber-400 px-3 py-1 font-semibold transition hover:border-amber-500 hover:text-amber-800 disabled:cursor-not-allowed disabled:border-amber-200 disabled:text-amber-300"
            {% if roasters.has_next() %}
            data-on:click="history.pushState(null, '', '{{ navigator.page_href(roasters.next_page().unwrap())|safe }}'); @get('{{ navigator.fragment_page_href(roasters.next_page().unwrap())|safe }}', {responseOverrides: {selector: '#roaster-list', mode: 'replace'}})"
            {% else %}
            disabled
            {% endif %}
          >
            <span>Next</span>
            <span aria-hidden="true">→</span>
          </button>
        </div>
        <label class="flex items-center gap-2 text-xs font-semibold text-stone-600">
          <span>Rows</span>
          <select
            class="rounded-md border border-amber-300 bg-white px-2 py-1 text-xs font-semibold text-amber-800 transition hover:border-amber-400"
            data-on:change="history.pushState(null, '', evt.target.selectedOptions[0].dataset.url); @get(evt.target.selectedOptions[0].dataset.href, {responseOverrides: {selector: '#roaster-list', mode: 'replace'}})"
          >
            <option value="5" data-href="{{ navigator.fragment_rows_href("5")|safe }}" data-url="{{ navigator.rows_href("5")|safe }}" {% if roasters.is_page_size(5) %}selected{% endif %}>5</option>
            <option value="10" data-href="{{ navigator.fragment_rows_href("10")|safe }}" data-url="{{ navigator.rows_href("10")|safe }}" {% if roasters.is_page_size(10) %}selected{% endif %}>10</option>
            <option value="20" data-href="{{ navigator.fragment_rows_href("20")|safe }}" data-url="{{ navigator.rows_href("20")|safe }}" {% if roasters.is_page_size(20) %}selected{% endif %}>20</option>
            <option value="50" data-href="{{ navigator.fragment_rows_href("50")|safe }}" data-url="{{ navigator.rows_href("50")|safe }}" {% if roasters.is_page_size(50) %}selected{% endif %}>50</option>
            <option value="all" data-href="{{ navigator.fragment_rows_href("all")|safe }}" data-url="{{ navigator.rows_href("all")|safe }}" {% if roasters.is_showing_all() %}selected{% endif %}>All</option>
          </select>
        </label>
      </div>
    </div>
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-amber-200 text-left text-sm text-stone-700">
        <thead class="bg-amber-200/60 text-xs font-semibold tracking-wide text-amber-900">
          <tr>
            {% set created_sorted = navigator.is_sorted_by("created-at") %}
            <th
              scope="col"
              class="px-4 py-3"
              aria-sort="{% if created_sorted %}{% if navigator.sort_direction() == "asc" %}ascending{% else %}descending{% endif %}{% else %}none{% endif %}"
            >
              <button
                type="button"
                class="flex items-center gap-1 text-amber-900 hover:text-amber-700"
                data-on:click="history.pushState(null, '', '{{ navigator.sort_href("created-at")|safe }}'); @get('{{ navigator.fragment_sort_href("created-at")|safe }}', {responseOverrides: {selector: '#roaster-list', mode: 'replace'}})"
              >
                <span>Added</span>
                {% if created_sorted %}
                {% if navigator.sort_direction() == "asc" %}
                <span aria-hidden="true">↑</span>
                {% else %}
                <span aria-hidden="true">↓</span>
                {% endif %}
                {% else %}
                <span aria-hidden="true">↕</span>
                {% endif %}
              </button>
            </th>
            {% set name_sorted = navigator.is_sorted_by("name") %}
            <th
              scope="col"
              class="px-4 py-3"
              aria-sort="{% if name_sorted %}{% if navigator.sort_direction() == "asc" %}ascending{% else %}descending{% endif %}{% else %}none{% endif %}"
            >
              <button
                type="button"
                class="flex items-center gap-1 text-amber-900 hover:text-amber-700"
                data-on:click="history.pushState(null, '', '{{ navigator.sort_href("name")|safe }}'); @get('{{ navigator.fragment_sort_href("name")|safe }}', {responseOverrides: {selector: '#roaster-list', mode: 'replace'}})"
              >
                <span>Name</span>
                {% if name_sorted %}
                {% if navigator.sort_direction() == "asc" %}
                <span aria-hidden="true">↑</span>
                {% else %}
                <span aria-hidden="true">↓</span>
                {% endif %}
                {% else %}
                <span aria-hidden="true">↕</span>
                {% endif %}
              </button>
            </th>
            {% set country_sorted = navigator.is_sorted_by("country") %}
            <th
              scope="col"
              class="px-4 py-3"
              aria-sort="{% if country_sorted %}{% if navigator.sort_direction() == "asc" %}ascending{% else %}descending{% endif %}{% else %}none{% endif %}"
            >
              <button
                type="button"
                class="flex items-center gap-1 text-amber-900 hover:text-amber-700"
                data-on:click="history.pushState(null, '', '{{ navigator.sort_href("country")|safe }}'); @get('{{ navigator.fragment_sort_href("country")|safe }}', {responseOverrides: {selector: '#roaster-list', mode: 'replace'}})"
              >
                <span>Country</span>
                {% if country_sorted %}
                {% if navigator.sort_direction() == "asc" %}
                <span aria-hidden="true">↑</span>
                {% else %}
                <span aria-hidden="true">↓</span>
                {% endif %}
                {% else %}
                <span aria-hidden="true">↕</span>
                {% endif %}
              </button>
            </th>
            {% set city_sorted = navigator.is_sorted_by("city") %}
            <th
              scope="col"
              class="px-4 py-3"
              aria-sort="{% if city_sorted %}{% if navigator.sort_direction() == "asc" %}ascending{% else %}descending{% endif %}{% else %}none{% endif %}"
            >
              <button
                type="button"
                class="flex items-center gap-1 text-amber-900 hover:text-amber-700"
                data-on:click="history.pushState(null, '', '{{ navigator.sort_href("city")|safe }}'); @get('{{ navigator.fragment_sort_href("city")|safe }}', {responseOverrides: {selector: '#roaster-list', mode: 'replace'}})"
              >
                <span>City</span>
                {% if city_sorted %}
                {% if navigator.sort_direction() == "asc" %}
                <span aria-hidden="true">↑</span>
                {% else %}
                <span aria-hidden="true">↓</span>
                {% endif %}
                {% else %}
                <span aria-hidden="true">↕</span>
                {% endif %}
              </button>
            </th>
            <th scope="col" class="px-4 py-3">Homepage</th>
            <th scope="col" class="px-4 py-3">Notes</th>
            {% if is_authenticated %}
            <th scope="col" class="px-4 py-3 text-right">Actions</th>
            {% endif %}
          </tr>
        </thead>
        <tbody class="divide-y divide-amber-200/70">
          {% for roaster in roasters.items %}
          <tr
            data-star-key="{{ roaster.id }}"
            data-sort-created-at="{{ roaster.created_at_sort_key }}"
            data-sort-name="{{ roaster.name }}"
            data-sort-country="{{ roaster.country }}"
            data-sort-city="{{ roaster.city }}"
            class="bg-amber-50/40 transition hover:bg-amber-50"
          >
            <td class="whitespace-nowrap px-4 py-3 text-xs font-medium text-stone-600">
              {{ roaster.created_at }}
            </td>
            <td class="px-4 py-3">
              <a
                href="{{ roaster.detail_path }}"
                class="font-semibold text-amber-800 hover:text-amber-600"
                >{{ roaster.name }}</a
              >
            </td>
            <td class="px-4 py-3 whitespace-nowrap">{{ roaster.country }}</td>
            <td class="px-4 py-3 whitespace-nowrap">{{ roaster.city }}</td>
            <td class="px-4 py-3">
              {% if roaster.has_homepage %}
              <a
                class="inline-flex items-center justify-center rounded-md border border-amber-400 bg-amber-200/50 p-2 text-amber-800 transition hover:border-amber-500 hover:text-amber-900"
                href="{{ roaster.homepage_url }}"
                target="_blank"
                rel="noreferrer noopener"
                aria-label="Visit {{ roaster.name }} homepage"
              >
                <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                  <path
                    fill-rule="evenodd"
                    d="M11.3 2a.7.7 0 0 0 0 1.4h3.3l-8.1 8.1a.7.7 0 1 0 1 1l8.1-8.1v3.3a.7.7 0 1 0 1.4 0V2.7A.7.7 0 0 0 16.3 2h-5Z"
                    clip-rule="evenodd"
                  />
                  <path
                    d="M4.7 5.2a1.5 1.5 0 0 1 1.5-1.5h2.1a.7.7 0 1 0 0-1.4H6.2a2.9 2.9 0 0 0-2.9 2.9v7.6a2.9 2.9 0 0 0 2.9 2.9h7.6a2.9 2.9 0 0 0 2.9-2.9v-2.1a.7.7 0 1 0-1.4 0v2.1a1.5 1.5 0 0 1-1.5 1.5H6.1a1.5 1.5 0 0 1-1.5-1.5V5.2Z"
                  />
                </svg>
              </a>
              {% else %}
              <span class="text-stone-400">&mdash;</span>
              {% endif %}
            </td>
            <td class="px-4 py-3 text-sm text-stone-600">{{ roaster.notes }}</td>
            {% if is_authenticated %}
            <td class="px-4 py-3 text-right">
              <button
                type="button"
                class="inline-flex h-8 w-8 items-center justify-center rounded-md text-stone-500 transition hover:text-red-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-500"
                title="Delete roaster"
                data-on:click="confirm('Delete this roaster?') && @delete('/api/v1/roasters/{{ roaster.id }}?{{ navigator.query() }}', {responseOverrides: {selector: '#roaster-list', mode: 'replace'}})"
              >
                <span class="sr-only">Delete</span>
                <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                  <path
                    fill-rule="evenodd"
                    d="M7.5 3a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1H15a1 1 0 1 1 0 2h-.4l-.74 10.36A2 2 0 0 1 11.87 17H8.13a2 2 0 0 1-1.99-1.64L5.4 5H5a1 1 0 1 1 0-2h2.5Zm.9 4.5a.75.75 0 0 1 .75.75v6a.75.75 0 1 1-1.5 0v-6a.75.75 0 0 1 .75-.75Zm3.4 0a.75.75 0 0 1 .75.75v6a.75.75 0 1 1-1.5 0v-6a.75.75 0 0 1 .75-.75Z"
                    clip-rule="evenodd"
                  />
                </svg>
              </button>
            </td>
            {% endif %}
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </section>
  {% endif %}
</div>
